syntax = "proto3";
package proto;
 
message QueryPQLRequest {
  string index = 1;
  string pql = 2;
}


message RowResponse{
  repeated ColumnInfo headers = 1;
  repeated ColumnResponse columns = 2;
}

message ColumnInfo {
  string name = 1;
  string datatype = 2;
}

message ColumnResponse{
  oneof columnVal {
    string stringVal = 1;
    uint64 uintVal = 2;
    int64 intVal = 3;
    bool boolVal = 4;
    bytes blobVal = 5;
  }
}

message InspectRequest {
  string index = 1;
  IdsOrKeys columns = 2;
  repeated string filterFields = 3;
}

message Ids {
  repeated uint64 vals = 1;
}

message Keys {
  repeated string vals = 1;
}

message IdsOrKeys {
  oneof type {
    Ids ids = 1;
    Keys keys = 2;
  }
}

message InspectResponse {
  repeated FieldValues fields = 1;
}

message FieldValues {
  string name = 1;
  IdsOrKeys values = 2;
}

service Pilosa {
  rpc QueryPQL(QueryPQLRequest) returns (stream RowResponse) {};
  rpc Inspect(InspectRequest) returns (stream InspectResponse) {};
}
